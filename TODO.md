cleanup code and add functionaity to add pieces etc
